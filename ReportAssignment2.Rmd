---
title: "Assignment 2 - Report"
author: "Eleni Liarou, ZoÃ« Azra Blei, Frederieke Loth, group 20"
date: "`r Sys.Date()`"
output:
  pdf_document:
    latex_engine: xelatex
fontsize: 11pt
highlight: tango
---

::: {style="text-align: justify;"}
# Exercise 1: Titanic

#### Section a

#### Section b

#### Section c

#### Section d

#### Section e

# Exercise 2: Military Coups

```{r echo=FALSE}
library(MASS)
data <- read.table("coups.txt", header = TRUE, row.names = 1)

# Transform 'pollib' into a factor, as we think it may not have a linear effect
data$pollib <- as.factor(data$pollib)
```

#### Section a
Note that we transformed *pollib* into a factor since we hypothesized the effect to not be strictly linear. This was found to be correct after comparing the different Poisson regression model outcomes. *pollib = 1* and *pollib = 2* are henceforth compared to the value of *pollib = 0*.

``` {r echo=FALSE}
poisson_reg <- glm (miltcoup ~ ., data = data, family = poisson)
summary(poisson_reg)
```

We determine that variables for which *p-value > 0.05* do not have a statistically significant effect on our response variable *miltcoup* which signifies the number of military coups. Moreover, a positive coefficient details that an increase in the corresponding variable indicates an increase in *miltcoup*. We can therefore state the following: *oligarchy* and *parties* are statistically significant with a positive effect on *miltcoup*. *pollib1* has a slightly significant and negative effect on *miltcoup* whilst *pollib2* has a significant negative effect. We can thus say that according to the data, countries with a higher political liberation factor may experience less military coups.

#### Section b
We will now remove variables from the model one-by-one to assess which variables are significant. For clarity we will only show the last model and comment on which variables were removed.

```{r echo=FALSE}
poisson_reg1 <- glm(miltcoup ~ oligarchy + pollib + parties + pctvote + popn + size + numregim, 
                    data = data,
                    family = poisson)

poisson_reg2 <- glm(miltcoup ~ oligarchy + pollib + parties + pctvote + popn + numregim, 
                    data = data,
                    family = poisson)

poisson_reg3 <- glm(miltcoup ~ oligarchy + pollib + parties + pctvote + popn, 
                    data = data,
                    family = poisson)

poisson_reg4 <- glm(miltcoup ~ oligarchy + pollib + parties + pctvote, 
                    data = data,
                    family = poisson)
```

At each step, we removed the variable with the largest p-value for which *p-value > 0.05*. This resulted in the final poisson model with variables *oligarchy*, *pollib*, and *parties*. Although *pollib1* has a *p-value > 0.05*, we include it to properly reflect the stages within the variable.

``` {r}
# Everything p < 0.05
poisson_reg_final <- glm(miltcoup ~ oligarchy + pollib + parties, 
                    data = data,
                    family = poisson)
summary(poisson_reg_final)
```

This final version of the model is in compliance with our findings for the previously determined statistically significant variables.

#### Section c

We will now use the final model to make predictions about the mean number of coups per level of liberalization. We create a hypothetical country with mean values for the numerical variables *oligarchy*, and *parties*, while varying *pollib* for all levels (0, 1, and 2). 

``` {r echo = FALSE}
# Get all columns of which to take average
selected_vars <- c("oligarchy", "parties") 

# Compute the means
cols_means <- colMeans(data[, selected_vars])
cols_means

# Create dataset for prediction with pollib as a factor
data2 <- data.frame(pollib = factor(c(0, 1, 2), levels = levels(data$pollib)), 
                    t(cols_means))

# Make prediction
predicted_coups <- predict(poisson_reg_final, newdata = data2, type = 'response')
data.frame(pollib = c(0, 1, 2), predicted_coups = predicted_coups)

```
From this we find the mean for *oligarchy* to be *5.222* and the mean for *parties* to be *17.083*. Furthermore we find the number of predicted coups to decrease as the index for political liberalization increases. We find that our hypothetical country with no political liberalization experiences roughly *2.91* military coups, with limited rights it experiences an estimated *1.77* coups and under full political liberalization it is estimated to expect roughly *0.96* military coups. These results indicate that greater political liberalization is associated with fewer military coups.

# Exercise 3: Stormer viscometer

#### Section a

#### Section b

#### Section c

#### Section d

#### Section e
:::
